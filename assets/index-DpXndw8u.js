import{ag as Qt,ah as eo,ai as h,aj as ct,ak as ut,W as t,al as to,P as ft,a9 as a,am as oo,z as no,an as io,ao as so,ap as ro,aq as lo}from"./three.core-DF9gDMDL.js";import{G as ao,O as co,C as uo}from"./three.examples-B3IXmiTy.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const d of i)if(d.type==="childList")for(const I of d.addedNodes)I.tagName==="LINK"&&I.rel==="modulepreload"&&o(I)}).observe(document,{childList:!0,subtree:!0});function s(i){const d={};return i.integrity&&(d.integrity=i.integrity),i.referrerPolicy&&(d.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?d.credentials="include":i.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function o(i){if(i.ep)return;i.ep=!0;const d=s(i);fetch(i.href,d)}})();const ne=document.getElementById("damage-overlay");function fo(){ne.style.opacity="0.8",setTimeout(()=>{ne.style.opacity="0",ne.classList.add("fade-out"),setTimeout(()=>{ne.classList.remove("fade-out")},1e3)},200)}const y=new Qt,m=new eo,j=new h(y);m.load("assets/sounds/abadoned-pyramid-atmo-orchestral-and-drone-sad-mood-9237.mp3",e=>{j.setBuffer(e),j.setLoop(!0),j.setVolume(.1)});const J=new h(y);m.load("assets/sounds/a-rainy-day-248712.mp3",e=>{J.setBuffer(e),J.setLoop(!0),J.setVolume(.2)});const Q=new h(y);m.load("assets/sounds/scaryviolins-6829.mp3",e=>{Q.setBuffer(e),Q.setLoop(!0),Q.setVolume(.8)});const ee=new h(y);m.load("assets/sounds/shepard-effect-edit.mp3",e=>{ee.setBuffer(e),ee.setLoop(!0),ee.setVolume(.6)});const Te=new h(y);m.load("assets/sounds/cringe-scare-47561.mp3",e=>{Te.setBuffer(e),Te.setVolume(.2)});const Ie=new h(y);m.load("assets/sounds/zombie-bite-96528.mp3",e=>{Ie.setBuffer(e),Ie.setVolume(.5)});const Ee=new h(y);m.load("assets/sounds/paper-245786.mp3",e=>{Ee.setBuffer(e),Ee.setVolume(.5)});const Be=new h(y);m.load("assets/sounds/closing-metal-door-44280.mp3",e=>{Be.setBuffer(e),Be.setVolume(.5)});const De=new h(y);m.load("assets/sounds/door-close-79921.mp3",e=>{De.setBuffer(e),De.setVolume(.4)});const Le=new h(y);m.load("assets/sounds/dropping-bag-95101.mp3",e=>{Le.setBuffer(e),Le.setVolume(.5)});const N=new h(y);m.load("assets/sounds/footsteps.mp3",e=>{N.setBuffer(e),N.setVolume(.4),N.setLoop(!0)});const k=new ct(y);m.load("assets/sounds/zombie-1-22336.mp3",e=>{k.setBuffer(e),k.setLoop(!0),k.setRefDistance(20),k.setVolume(.3)});const R=new ct(y);m.load("assets/sounds/fluorescent-lamp-flickering-17625.mp3",e=>{R.setBuffer(e),R.setRefDistance(3),R.setVolume(.9),R.setLoop(!0)});function yo(e){e.add(y)}function yt(e){e.add(k)}function po(e){e.add(R),R.play()}function pt(){j.play()}function mo(){J.play()}function go(){k.play()}function mt(){j.stop(),J.stop(),k.stop()}function ho(){Ie.play(),Te.play()}function wo(){mt(),Q.play(),ee.play(),k.play()}function xo(){Q.stop(),ee.stop(),k.stop(),ho(),pt()}function we(){Ee.play()}function bo(){Be.play()}function vo(){De.play()}function ko(){Le.play()}function To(){N.isPlaying||N.play()}function Io(){N.pause()}let c,u,_e,qe,Xe,Se,Ue,te,G=!1,Ce=!1;const Eo=2,je=document.getElementById("infected-bite");function Bo(e,n,s,o="Run_InPlace"){n.load(e,i=>{c=i.scene,c.position.x=-19,c.position.z=1.5,yt(c),s.add(c),c.traverse(function(I){I.isMesh&&(I.castShadow=!0)});const d=i.animations;u=new ut(c),_e=u.clipAction(d[0]),qe=u.clipAction(d[1]),Xe=u.clipAction(d[2]),Se=u.clipAction(d[3]),Ue=u.clipAction(d[4]),te=u.clipAction(d[5]),u.clipAction(d[6]),o==="Idle"?_e.play():o==="Walk1_InPlace"?qe.play():o==="Walk2_InPlace"?Xe.play():o==="Run_InPlace"?Se.play():o==="Attack"&&Ue.play()})}function Do(){Se.stop(),te.loop=to,te.clampWhenFinished=!0,te.play()}function Lo(e,n){if(!c||Ce)return;if(n.start.distanceTo(c.position)<2&&!G){xo(),Do(),fo(),G=!0;return}if(G){u&&(u.update(e),te.isRunning()||(G=!1,Ce=!0,console.log("Infected is dead"),je.style.visibility="visible",setTimeout(()=>{je.style.visibility="hidden"},5e3)));return}u&&u.update(e);const s=n.end,o=new t;o.subVectors(new t(s.x,c.position.y,s.z),c.position).normalize(),c.position.add(o.multiplyScalar(Eo*e));const i=new t(s.x,c.position.y,s.z);c.lookAt(i)}function So(){u&&(u.stopAllAction(),u.uncacheRoot(c),u=null),c&&(c.traverse(e=>{e.isMesh&&(e.geometry.dispose(),e.material.isMaterial?e.material.dispose():Array.isArray(e.material)&&e.material.forEach(n=>n.dispose()))}),c.parent&&c.parent.remove(c),c=null),Ce=!1,G=!1}const Co="2231",x=document.getElementById("code-input"),Je=document.getElementById("solved-code-text");function Ao(){x.innerText="",Yo()}function Po(){return x.innerText===Co?!0:(x.innerText.length===4&&(x.innerText=""),!1)}function zo(e){x.innerText.length<4&&(x.innerText+=e)}function gt(e){e.key>="0"&&e.key<="9"&&zo(e.key),e.key==="Enter"&&(Po()?(console.log("Code accepted"),x.innerText="Correct!",Je.style.visibility="visible",tn(),ti(),wo(),setTimeout(()=>{en(),x.innerText="",Je.style.visibility="hidden"},3e3)):(console.log("Code rejected"),x.innerText="Wrong!",setTimeout(()=>{x.innerText=""},1e3)))}function Mo(){document.addEventListener("keyup",gt)}function Yo(){document.removeEventListener("keyup",gt)}let ht=!1,W=!1,H=!1,ie=!1,_=!1,q=!1,X=!1;const Ro=new a(new t(-7.55,0,-5.5),new t(-5,3,.5)),Wo=new a(new t(-31,0,-28),new t(-29,3,-24)),wt=new a(new t(-37,0,0),new t(-33,3,3.5)),Vo=new a(new t(-13,0,-60),new t(-10.5,3,-57)),Oo=new a(new t(-5.3,0,-10),new t(-3,3,-7.5)),Fo=new a(new t(-22,0,.6),new t(-19,3,3.5)),xt=document.getElementById("door-text"),bt=document.getElementById("corpse-text"),vt=document.getElementById("file-text"),kt=document.getElementById("report-text"),Tt=document.getElementById("charles-note-text"),It=document.getElementById("code-text"),Et=document.getElementById("exit-prompt"),Bt=document.getElementById("door-exam"),Dt=document.getElementById("corpse-exam"),ye=document.getElementById("corpse-timeline"),pe=document.getElementById("report"),me=document.getElementById("charles-note"),$=document.getElementById("faded-screen");ye.style.visibility="hidden";pe.style.visibility="hidden";me.style.visibility="hidden";function No(){W&&(ht?(Lt(),bo(),K("reception"),W=!1):(vo(),Zo())),H&&(ko(),Go()),_&&(ye.style.visibility==="hidden"?(we(),Xo(),At(),xe()):(St(),Ct(),b())),q&&(pe.style.visibility==="hidden"?(we(),Uo(),Mt(),xe()):(Pt(),zt(),b())),X&&(me.style.visibility==="hidden"?(we(),jo(),Wt(),xe()):(Yt(),Rt(),b()))}function xe(){Et.style.display="block"}function b(){Et.style.display="none"}function Zo(){Bt.style.visibility="visible"}function Ko(){Bt.style.visibility="hidden"}function $o(){xt.style.visibility="visible"}function Lt(){xt.style.visibility="hidden"}function Go(){Dt.style.visibility="visible"}function Ho(){Dt.style.visibility="hidden"}function _o(){bt.style.visibility="visible"}function qo(){bt.style.visibility="hidden"}function Xo(){ye.style.visibility="visible",$.style.visibility="visible"}function St(){ye.style.visibility="hidden",$.style.visibility="hidden"}function Ct(){vt.style.visibility="visible"}function At(){vt.style.visibility="hidden"}function Uo(){pe.style.visibility="visible",$.style.visibility="visible"}function Pt(){pe.style.visibility="hidden",$.style.visibility="hidden"}function zt(){kt.style.visibility="visible"}function Mt(){kt.style.visibility="hidden"}function jo(){me.style.visibility="visible",$.style.visibility="visible"}function Yt(){me.style.visibility="hidden",$.style.visibility="hidden"}function Rt(){Tt.style.visibility="visible"}function Wt(){Tt.style.visibility="hidden"}function Jo(){It.style.visibility="visible"}function Qo(){It.style.visibility="hidden"}function en(){wt.makeEmpty()}function tn(){ht=!0}function on(e){e.intersectsBox(Ro)?W||(console.log("Entered the door trigger zone"),$o(),W=!0):W&&(console.log("Exited the door trigger zone"),Lt(),Ko(),b(),W=!1),e.intersectsBox(Wo)?H||(console.log("Entered the corpse trigger zone"),_o(),H=!0):H&&(console.log("Exited the corpse trigger zone"),qo(),Ho(),b(),H=!1),e.intersectsBox(wt)?ie||(console.log("Entered the code trigger zone"),Jo(),Mo(),ie=!0):ie&&(console.log("Exited the code trigger zone"),Qo(),Ao(),b(),ie=!1),e.intersectsBox(Vo)?_||(console.log("Entered the file trigger zone"),Ct(),_=!0):_&&(console.log("Exited the file trigger zone"),At(),St(),b(),_=!1),e.intersectsBox(Oo)?q||(console.log("Entered the report trigger zone"),zt(),q=!0):q&&(console.log("Exited the report trigger zone"),Mt(),Pt(),b(),q=!1),e.intersectsBox(Fo)?X||(console.log("Entered the Charles note trigger zone"),Rt(),X=!0):X&&(console.log("Exited the Charles note trigger zone"),Wt(),Yt(),b(),X=!1)}const P=new ft(16777215,20);P.position.set(-8,2.4,-60);function nn(e){po(P),e.add(P)}function Qe(e){return Math.floor(Math.random()*e)}function sn(){P.visible&&Qe(320)==1&&(P.visible=!1),P.visible||Qe(40)==1&&(P.visible=!0)}let E,se,et;function rn(e,n,s,o=new t(0,0,-8),i=new t(0,0,0)){n.load(e,d=>{E=d.scene,E.scale.set(.6,.6,.6),E.position.set(o.x,o.y,o.z),E.rotation.set(i.x,i.y,i.z),yt(E),go(),s.add(E),E.traverse(function(He){He.isMesh&&(He.castShadow=!0)});const I=d.animations;se=new ut(E),et=se.clipAction(I[0]),et.play()})}function ln(e){se&&se.update(e)}const Vt=document.getElementById("blackscreen"),Ot=document.getElementById("intro-text");function an(){Vt.style.visibility="visible",Ot.style.visibility="visible"}function dn(){Vt.style.visibility="hidden",Ot.style.visibility="hidden"}function cn(e){function n(s){window.removeEventListener("keydown",n),e&&e(s)}window.addEventListener("keydown",n)}const Ft=document.getElementById("drawer1-text"),Nt=document.getElementById("drawer2-text"),re=document.getElementById("gooddrawer-text"),ge=document.getElementById("items-container"),Zt=document.getElementById("blur"),Ae=document.getElementById("bad-text"),Ze=document.getElementById("good-text"),Pe=document.getElementById("searched-text"),le=document.getElementById("useCard-text"),tt=document.getElementById("noCard-text"),Kt=document.getElementById("dontOpen-text"),un=document.getElementById("Open-text");let ae=!1,de=!1,z=!1,V=!1,O=!1,ze=!1,B=!1,Me=!1,C;function fn(){ae&&(f(Ft),F(Ae)),de&&(f(Nt),F(Ae)),z&!B?(f(re),ze=!0):z&B&Ze.style.visibility=="hidden"?(f(re),F(Pe)):z&B&ge.style.display=="flex"&&(f(Pe),$t()),V&B&&(f(le),F(Kt)),O&B&&(f(le),Me=!0)}function $t(){ae|de&&f(Ae),z&&(f(Pe),f(Ze),f(re),ge.style.display="none",Zt.style.display="none"),V&&f(Kt),O&&f(un)}function F(e){e.style.visibility="visible"}function f(e){e.style.visibility="hidden"}const yn=new a(new t(3.3,0,4),new t(6.1,2.8,4.6)),pn=new a(new t(1.5,0,-2.5),new t(2.5,2,-1.5)),mn=new a(new t(-1.7,0,-1.75),new t(-.7,2,-.75)),gn=new a(new t(-.25,0,-1.5),new t(.75,2,-.5)),ot=new a(new t(4.35,0,-4.6),new t(5.85,2,-4.2)),be=new a(new t(-5.5,0,-4.6),new t(-4,2,-4.2));function S(e,n,s,o){if(e.intersectsBox(n)){if(!s)return console.log("Entered the trigger zone"),F(o),!0}else if(s)return console.log("Exited the trigger zone"),f(o),$t(),!!(z&B&ge.style.display=="flex");return s}function hn(e,n,s){n.load(e,o=>{C=o.scene,C.scale.set(2.3,1.778,1),C.position.set(.2,.739,-.571),C.rotation.y+=Math.PI,s.add(C)})}function wn(e){e.intersectsBox(yn)&&K("exterior"),e.intersectsBox(be)&Me==!0&&(Me=!1,K("corridor")),ae=S(e,pn,ae,Ft),de=S(e,mn,de,Nt),z=S(e,gn,z,re),B?(V=S(e,ot,V,le),O=S(e,be,O,le)):(V=S(e,ot,V,tt),O=S(e,be,O,tt)),ze&&(C.position.z>-.9?C.position.z-=.01:(F(Ze),ge.style.display="flex",Zt.style.display="block",B=!0,ze=!1))}const M=document.getElementById("openDoor-text"),Gt=document.getElementById("closedDoor-text"),Ht=document.getElementById("zombieDoor-text");let Ye=!1,Re=!1,We=!1;function xn(){Ye&&(D(M),ce(Gt)),We&&(D(M),K("room")),Re&&(D(M),ce(Ht))}function _t(){D(M),D(Gt),D(Ht)}function ce(e){e.style.visibility="visible"}function D(e){e.style.visibility="hidden"}const bn=new a(new t(1.25,-.05,-14.65),new t(1.75,2.05,-13.85)),vn=new a(new t(3.35,-.05,-14),new t(3.85,2.05,-13.2)),kn=new a(new t(3.35,-.05,-9.8),new t(3.85,2.05,-9)),Tn=new a(new t(1.25,-.05,-8.7),new t(1.75,2.05,-7.9)),In=new a(new t(3.35,-.05,-5.1),new t(3.85,2.05,-4.3)),En=new a(new t(3.35,-.05,1.094),new t(3.85,2.05,1.894)),Bn=new a(new t(3.35,-.05,7.5),new t(3.85,2.05,8.3)),Dn=new a(new t(1.25,-.05,2.6),new t(1.75,2.05,3.4)),Ln=new a(new t(1.25,-.05,7.5),new t(1.75,2.05,8.3)),Sn=new a(new t(1.8,0,-16.5),new t(3.3,2.2,-16.1)),Cn=[bn,vn,kn,Tn,In,En,Bn];function nt(e,n,s,o){if(e.intersectsBox(n)){if(!s)return console.log("Entered the trigger zone"),ce(o),!0}else if(s)return console.log("Exited the trigger zone"),D(o),_t(),!1;return s}function An(e,n,s,o){let i=!1;for(const d of n)if(e.intersectsBox(d))return s||(console.log("Entered the trigger zone"),ce(o)),!0;return s&!i&&(console.log("Exited the trigger zone"),D(o),_t()),!1}function Pn(e){e.intersectsBox(Sn)&&K("reception"),Ye=An(e,Cn,Ye,M),Re=nt(e,Dn,Re,M),We=nt(e,Ln,We,M)}const Ke=document.getElementById("launchDialogue-text"),$e=document.getElementById("dialogue-container"),zn=document.getElementById("dialogue-text"),it=document.getElementById("dialogue-speaker"),qt=document.getElementById("blur"),Xt=document.getElementById("exit-prompt"),Ge=document.getElementById("pause-overlay"),Mn=document.getElementById("pause-text");let ue=!1,he=!1,U=0;const Yn=[{speaker:"Brother",text:"You came all the way here for me? Are you ok?"},{speaker:"You",text:"Of course I did. I just feel a little tired, some creature bit me. But it's ok."},{speaker:"Brother",text:"Bit you...?"},{speaker:"You",text:"Yeah but that's nothing to care about."},{speaker:"Brother",text:"Of course it's something to care about! Let me see your eyes."},{speaker:"Brother",text:"That's what I thought. Your eyes are so red... You're infected."},{speaker:"You",text:"Infected? You mean I'll become one of them?"},{speaker:"Brother",text:"One of us..."},{speaker:"You",text:"You're infected too...?!"},{speaker:"Brother",text:"Yeah, we were only two survivors, my doctor and I. We barricaded ourselves in this corridor."},{speaker:"You",text:"Now that I think about it I saw an infected in the room next door..."},{speaker:"Brother",text:"We tried to leave the hospital but we were attacked, we got infected."},{speaker:"Brother",text:"I don't know why, but my symptoms took a lot longer than his to develop."},{speaker:"Brother",text:"While searching why I resisted to the infection, my doctor found an antidote."},{speaker:"You",text:"Amazing! Where is it??"},{speaker:"Brother",text:"That's the problem... Frederic didn't finish the antidote. He needed a last ingredient."},{speaker:"You",text:"Wait, Frederic? Is that the name of your doctor?"},{speaker:"Brother",text:"Yes, why?"},{speaker:"You",text:"I found a paper from a certain Dr. Frederic Bloupin. There was a bottle with it."},{speaker:"Brother",text:"Are you kiding me? So you have the final piece! We can escape from here safely!"},{speaker:"You",text:"Finally some good news..."},{speaker:"Pause",text:"A few moments later..."},{speaker:"You",text:"It's done but..."},{speaker:"Brother",text:"We only have one dose of remedy."},{speaker:"You",text:"..."},{speaker:"Brother",text:"..."},{speaker:"You",text:"You should take it."},{speaker:"Brother",text:"No, you should! You have better chances of survival."},{speaker:"You",text:"But you were here for so long waiting to escape..."},{speaker:"Brother",text:"Take it."},{speaker:"Pause",text:`Make a choice
Press Y to save your Brother. Press N to save yourself.`}],Rn=[{speaker:"Brother",text:"Go and live a long life. I'll miss you."},{speaker:"Pause",text:`You took the remedy and left the hospital. An infected attacked you and wounded you to death. You died alone in the parking lot of the hospital, while your brother fell asleep for an endless night.
Bad ending...`}],Wn=[{speaker:"Brother",text:"I can't take it, you came all the way here for me..."},{speaker:"You",text:"You are my little brother. It's my duty to protect you."},{speaker:"Pause",text:`Your brother took the remedy. While you helped him escape the hospital, he saw a locker looking quite familiar to him. It was Frederic's locker! You found an other dose of the remedy and escaped together safely.
Congratulations!`}];let oe=Yn;const Vn=new a(new t(-2.9,0,-4.3),new t(-.5,3.5,-3.7)),On=new a(new t(-3,0,-2.5),new t(-1,4,1.5));function Fn(e){e.speaker==="Pause"?($e.style.display="none",Ge.style.display="flex",Mn.innerText=e.text):(it.innerText=e.speaker,it.style.color=e.speaker==="You"?"green":"#ffcc00",zn.innerText=e.text)}function Nn(){Ke.style.visibility="hidden",he=!0,$e.style.display="block",qt.style.display="block",Xt.style.display="block",Ge.style.display="none"}function Zn(){Ke.style.visibility="visible",he=!1,$e.style.display="none",qt.style.display="none",Xt.style.display="none",Ge.style.display="none"}function Ve(){ue&U<oe.length?(Nn(),Fn(oe[U]),U++):ue&U>=oe.length}function Kn(){he&&Zn()}function Ut(e){U=0,e?(oe=Wn,Ve()):(oe=Rn,Ve())}function $n(e,n,s,o){if(e.intersectsBox(n)){if(!s)return console.log("Entered the trigger zone"),o.style.visibility="visible",!0}else if(s)return console.log("Exited the trigger zone"),o.style.visibility="hidden",!1;return s}function Gn(e){he||(e.intersectsBox(Vn)&&K("corridor"),ue=$n(e,On,ue,Ke))}const Hn=new lo,L=new oo,l=new no(70,window.innerWidth/window.innerHeight,.1,1e3);l.rotation.order="YXZ";const jt=document.getElementById("container"),T=new io({antialias:!0});T.setPixelRatio(window.devicePixelRatio);T.setSize(window.innerWidth,window.innerHeight);T.setAnimationLoop(oi);T.shadowMap.enabled=!0;T.shadowMap.type=so;T.toneMapping=ro;jt.appendChild(T.domElement);const _n=80,st=1,Oe=new co,r=new uo(new t(0,.35,0),new t(0,1,0),.35),Z=new ft(16777215,.5),g=new t,v=new t;let Y=!1;const w={},fe=new ao().setPath("/RAUG-Cahet-Codron/assets/models/");let A=!1,p="exterior",Fe="exterior",rt=!1;const Ne={},ve=document.getElementById("loader"),ke=document.getElementById("blackscreen"),lt=document.querySelector(".loading-bar");document.addEventListener("keydown",e=>{Ne[e.code]||(w[e.code]=!0,Ne[e.code]=!0)});document.addEventListener("keyup",e=>{w[e.code]=!1,Ne[e.code]=!1});jt.addEventListener("mousedown",()=>{document.body.requestPointerLock()});document.body.addEventListener("mousemove",e=>{document.pointerLockElement===document.body&&(l.rotation.y-=e.movementX/500,l.rotation.x-=e.movementY/500)});document.addEventListener("keyup",e=>{e.code==="KeyE"&&(No(),p==="reception"&&fn(),p==="corridor"&&xn(),p==="room"&&Kn())});document.addEventListener("keyup",e=>{e.code==="KeyY"&&p==="room"&&Ut(!0)});document.addEventListener("keyup",e=>{e.code==="KeyN"&&p==="room"&&Ut(!1)});document.addEventListener("keyup",e=>{e.code==="Space"&&p==="room"&&Ve()});window.addEventListener("resize",qn);function qn(){l.aspect=window.innerWidth/window.innerHeight,l.updateProjectionMatrix(),T.setSize(window.innerWidth,window.innerHeight)}function Xn(){const e=Oe.capsuleIntersect(r);Y=!1,e&&(Y=e.normal.y>0,Y||g.addScaledVector(e.normal,-e.normal.dot(g)),e.depth>=1e-10&&r.translate(e.normal.multiplyScalar(e.depth)))}function Un(e){let n=Math.exp(-4*e)-1;Y||(g.y-=_n*e,n*=.1),g.addScaledVector(g,n);const s=g.clone().multiplyScalar(e);r.translate(s),Xn();let o=r.end.clone();o.y+=.8,l.position.copy(o),Z.position.copy(r.end)}function at(){return l.getWorldDirection(v),v.y=0,v.normalize(),v}function dt(){return l.getWorldDirection(v),v.y=0,v.normalize(),v.cross(l.up),v}function jn(e){const n=e*(Y?25:8);(w.KeyW||w.KeyS||w.KeyA||w.KeyD)&&!A?To():Io(),w.KeyW&&!A&&g.add(at().multiplyScalar(n)),w.KeyS&&!A&&g.add(at().multiplyScalar(-n)),w.KeyA&&!A&&g.add(dt().multiplyScalar(-n)),w.KeyD&&!A&&g.add(dt().multiplyScalar(n))}function Jn(){const e=new a().setFromPoints([r.start,r.end]);p==="exterior"&&on(e),p==="reception"&&wn(e),p==="corridor"&&Pn(e),p==="room"&&Gn(e)}function Jt(e){return new Promise((n,s)=>{console.log("Loading room:",e),ke.style.visibility="visible",ve.style.visibility="visible",A=!0,Y=!0,g.y=0,fe.load(e,o=>{try{So(),L.clear(),Oe.clear(),L.add(o.scene),L.add(Z),o.scene.traverse(i=>{i.isMesh&&(i.castShadow=!0,i.receiveShadow=!0,i.material.map&&(i.material.map.anisotropy=4))}),setTimeout(()=>{console.log("Computing octree..."),Oe.fromGraphNode(o.scene),Qn(e),setTimeout(()=>{console.log("Room fully loaded and collision ready"),ve.style.visibility="hidden",ke.style.visibility="hidden",A=!1,lt.style.width="0%",r.start.copy(l.position).y-=.35,r.end.copy(l.position).y+=.35,Y=!1,n()},100)},50)}catch(i){console.error("Error processing room:",i),s(i)}},o=>{const i=Math.round(o.loaded/o.total*100);lt.style.width=i+"%",console.log(i+"%")},o=>{console.error("An error occurred while loading the model:",o),ve.style.visibility="hidden",ke.style.visibility="hidden",s(o)})})}function Qn(e){switch(mt(),e){case"exterior.glb":r.start.set(0,.35,0),r.end.set(0,1,0),l.position.copy(r.end),l.rotation.set(0,0,0),pt(),nn(L);break;case"reception.glb":Fe==="exterior"?(r.start.set(5,.675,3),r.end.set(5,1.325,3),l.rotation.set(0,0,0)):(r.start.set(-4.7,.675,-3.5),r.end.set(-4.7,1.325,-3.5),l.rotation.set(0,Math.PI,0)),l.position.copy(r.end),Z.position.copy(r.end),hn("drawer.glb",fe,L);break;case"corridor.glb":Fe==="reception"?(r.start.set(2.2,.675,-15),r.end.set(2.2,1.325,-15),l.rotation.set(0,Math.PI,0)):(r.start.set(2,.675,8),r.end.set(2,1.325,8),l.rotation.set(0,0,0)),l.position.copy(r.end),Z.position.copy(r.end),rn("idle-infected.glb",fe,L,new t(-2,0,3.5),new t(0,180,0));break;case"room.glb":r.start.set(0,1.5,-2.6),r.end.set(0,2.15,-2.6),l.rotation.set(0,Math.PI,0),l.position.copy(r.end),Z.position.copy(r.end),mo();break}}function K(e){Fe=p,p=e,Jt(e+".glb")}function ei(){l.position.y<=-25&&(r.start.set(0,.35,0),r.end.set(0,1,0),r.radius=.35,l.position.copy(r.end),l.rotation.set(0,0,0),Z.position.copy(r.end))}function ti(){Bo("moving-infected.glb",fe,L)}yo(l);an();rt||cn(()=>{rt=!0,dn(),Jt(p+".glb")});function oi(){const e=Math.min(.05,Hn.getDelta())/st;for(let n=0;n<st;n++)Lo(e,r),ln(e),jn(e),Un(e),ei(),sn(),Jn();T.render(L,l)}
//# sourceMappingURL=index-DpXndw8u.js.map
